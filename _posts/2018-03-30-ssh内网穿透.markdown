---
title:      "ssh实现内网穿透"
subtitle:   " \"ssh\""
date:       2018-03-30 12:00:00
author:     "CESIGN"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - 杂
title:      "ssh实现内网穿透"
date:       2018-03-05 12:00:00
categories:
- lan
tags:
    - 杂
---
> "python安装问题"

##  问题

A主机为公网IP，B，C主机为内网IP，现在需要B连接C主机。

##  实现(命令)
对于服务器A:
~~~
#生成密钥，并复制到C（实现免密登陆）
>ssh-keygen
#复制通过scp
#在C上输入
>scp username@addr:~/.ssh/id_rsa.pub
>cat id_rsa.pub >> ~/.ssh/authorized_keys
~~~
对于C
~~~
#把远程的6766端口映射到本地22端口
>autossh -p 22 -M 6777 -NR '*:6766:127.0.0.1:22' username@addr
~~~
然后在A上执行
~~~
#编辑/etc/ssh/sshd_config,加入 GatewayPorts yes
#重启sshd, service sshd restart
#实现B登陆到C
>ssh -p 6777 userb@addr
~~~
实现80端口也一样的

—— cesign 后记于 2018.03
